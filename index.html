<!DOCTYPE html>
<html>
<head>
	<title>Bhaskar's Hangman Game</title>
	<script src="https://code.jquery.com/jquery.js"></script>
	<!-- <link src="assets/css/reset.css" rel="stylesheet"> -->
	<link href="assets/css/style.css" rel="stylesheet" type="text/css">
	<link href="https://fonts.googleapis.com/css?family=EB+Garamond:400,400i,500,500i|Spectral+SC:400,500" rel="stylesheet">
</head>
<body>

	<header>
		<h1>Hangman</h1>
	</header>

	<div class="container">

		<aside id="aside-left">
			<img id="hangman-image" src="#">
		</aside>

		<section>
			<p id="instructions"></p>
			<p id="word-to-guess"></p>
			<p id="guess-tracker">Letters already guessed: <span id="guessed-letters"></span></p>
		</section>

		<aside id="aside-right">
			<p>Number of wins: <span id="win-count">0</span></p>
			<p id="correct-guess"></p>
			<p>Guesses remaining: <span id="guesses-remaining"></span></p>
			<button id="reset">Reset Game</button>
		</aside>


	<script type=text/javascript>

		var wordList = ["SHIGETO","STAVROS"]; // list of words for the game
		var maxWins = wordList.length; // maximum number of wins
		var guessesAllowed = 6; // number of guesses allowed per word
		var alphabet = createAlphabet(); // array to check if guessed letter is in alphabet

		function createAlphabet() {
			var alphabet_array = [];
			for (var i = 65; i <= 90; i++) {
				alphabet_array.push(String.fromCharCode(i));
			}
			return alphabet_array;
		}

		function imageServer(guessesRemaining) {
			return "assets/images/Hangman-" + (guessesAllowed-guessesRemaining).toString() + ".png";
		}

		var Hangman = {
			"numWins":0,
			"guessesRemaining":guessesAllowed,
			"lettersGuessed":[],
			"wordsGuessed":0,
			"wordArray": [],
			currentWord: function () {
				return wordList[this.numWins];
			},
			initializeWordArray: function() {
				this.wordArray = [];
				for (var i = 0; i < this.currentWord().length; i++) {
					this.wordArray.push("_");
				}
			},
			updateWordArray: function(letter) {
				for (var i = 0; i < this.currentWord().length; i++) {
					if (letter === this.currentWord()[i]) {
						this.wordArray[i] = letter;
					}
				}
			},
			displayWord: function() {
				return this.wordArray.join(" ");
			},
			winState: function() {
				return !this.wordArray.includes("_");
			},
			reset: function() {
				this.guessesRemaining = guessesAllowed;
				this.wordsGuessed = 0;
				this.lettersGuessed = [];
				this.initializeWordArray();
			},
		};

		function playGame() {

			function updateDisplay() {
				$("#win-count").html(Hangman.numWins);
				$("#guesses-remaining").html(Hangman.guessesRemaining);
				$("#word-to-guess").html(Hangman.displayWord());
				$("#guessed-letters").html(Hangman.lettersGuessed.join(", "));
				$("#hangman-image").attr("src",imageServer(Hangman.guessesRemaining));
			}

			Hangman.initializeWordArray();
			updateDisplay();
			$("#instructions").html("Press any key to get started.");


			$(document).keyup(function(e) {
				var currentWord = Hangman.currentWord();
				var guess = String.fromCharCode(e.which);
				var letterIndex = currentWord.indexOf(e.which);

				// if guessed letter is not in the alphabet
				if (alphabet.indexOf(guess) === -1) { 
					$("#instructions").html("Only guesses in the standard alphabet are allowed."); 
				}
				// if guessed letter has already been guessed
				else if (Hangman.lettersGuessed.indexOf(guess) != -1) { 
					$("#instructions").html("You've already guessed that letter. Please guess another letter.");
				}
				// if guessed letter is in the current word
				else if (Hangman.currentWord().indexOf(guess) != -1) {
					Hangman.updateWordArray(guess);
					$("#instructions").html("Nice job!");
				}
				// if guessed letter is not in current word
				else {
					Hangman.lettersGuessed.push(guess);
					$("#instructions").html("Try again.");
					Hangman.guessesRemaining--;
				}
				// if player has run out of guesses
				if (Hangman.guessesRemaining === 0) {
					updateDisplay();
					alert("Sorry, you're out of luck! Try again.");
					window.setTimeout(function() {Hangman.reset(); updateDisplay();
					$("#instructions").html("Press any key to get started.");}, 2000);
				}
				// if the word has been correctly guessed
				if (Hangman.winState() === true) {
					$("#correct-guess").html("Last word guessed: " + Hangman.currentWord())
					if (Hangman.numWins+1 < maxWins) {
						Hangman.numWins++;
						Hangman.reset();
						$("#instructions").html("Press any key to get started.");
					}
					else {
						alert("You've correctly guessed all the words! Game will be reset.");
						Hangman.reset();
						Hangman.numWins = 0;
					}

				}

				updateDisplay();

				console.log("Guess: ",guess);
				console.log("Word array: ",Hangman.wordArray);
				console.log("Letters guessed: ",Hangman.lettersGuessed);
				console.log("Guesses remaining: ",Hangman.guessesRemaining);
				console.log("Game won?: ",Hangman.winState());

		})

		$("#reset").on("click", function() {
			Hangman.reset();
			Hangman.numWins = 0;
			Hangman.initializeWordArray();

			updateDisplay();
		})

	};

		
	$(document).ready(playGame);


	</script>

</body>
</html>